# /* ---- ðŸ’« https://github.com/JaKooLit ðŸ’« ---- */
# Hypridle â€” reliable staged idle -> lock -> dpms off -> suspend

# Optional icon dir for notifications
#$iDIR="$HOME/.config/swaync/images/ja.png"

general {
    # Lock screen on demand or before sleep (only start hyprlock if not already running)
    lock_cmd = pidof hyprlock || hyprlock
    # Donâ€™t kill hyprlock on unlock; let it exit cleanly
    # unlock_cmd = killall hyprlock

    # Make absolutely sure weâ€™re locked before sleeping
    before_sleep_cmd = loginctl lock-session

    # Wake displays after resume (Hyprland sometimes needs a nudge)
    after_sleep_cmd = hyprctl dispatch dpms on

    # IMPORTANT: ignore app inhibitors; otherwise a playing video can block suspend
    ignore_dbus_inhibit = true
}

# 1) Warn at 5 minutes
listener {
    timeout = 300  # 5 min
    on-timeout = notify-send -u low "ðŸ’¤ You seem idle" "Locking in 5 minutes if no activity."
    on-resume  = notify-send -u low "Welcome back!" "Idleness cancelled."
}

# 2) Lock at 10 minutes
listener {
    timeout = 600  # 10 min
    on-timeout = loginctl lock-session
    # on-resume = notify-send "Unlocked"
}

# 3) Turn off screens at 12 minutes (saves power; also keeps OLEDs safe)
listener {
    timeout = 720  # 12 min
    on-timeout = hyprctl dispatch dpms off
    on-resume  = hyprctl dispatch dpms on
}

# 4) Suspend at 20 minutes
listener {
    timeout = 1200  # 20 min
    # If you prefer hybrid: systemctl suspend-then-hibernate
    on-timeout = systemctl suspend
    on-resume  = notify-send -u low "System resumed"
}

