########################################
#             WINDOW RULES             #
########################################

# ─────────────────────────────────────
#  APP → WORKSPACE PLACEMENT (ORDER MATTERS)
# ─────────────────────────────────────
# Generic Brave first → ChatGPT-in-Brave after it (more specific) so it wins.
# Known Brave classes:
#   - brave
#   - Brave-browser
#   - app.brave.Browser       (Flatpak)
# Ghostty:
#   - com.mitchellh.ghostty

# Brave (generic): workspace 1
windowrulev2 = workspace 1, class:^(brave-browser|app\.brave\.Browser)$

# Brave → ChatGPT (PWA/window): workspace 11 (overrides generic rule above)
windowrulev2 = workspace 11, class:^(brave|Brave-browser|app\.brave\.Browser|Brave)$, title:^ChatGPT(.*)$
windowrulev2 = workspace 11, class:^(brave|Brave-browser|app\.brave\.Browser|Brave)$, initialtitle:^ChatGPT(.*)$

# Ghostty: workspace 2
windowrulev2 = workspace 2, class:^(com\.mitchellh\.ghostty)$


# ─────────────────────────────────────
#   BLUR & OPACITY
# ─────────────────────────────────────
# Ghostty: disable blur, near-opaque for readability
windowrulev2 = noblur, class:^(com\.mitchellh\.ghostty)$
windowrulev2 = opacity 0.99 override 0.99 override, class:^(com\.mitchellh\.ghostty)$

# Global transparency template (disabled, affects all windows)
#windowrulev2 = opacity 0.89 override 0.89 override, class:.*

# Disable blur for empty-class/title Xwayland popups
windowrulev2 = noblur, class:^()$, title:^()$
# Blanket disable for all Xwayland (optional)
# windowrulev2 = noblur, xwayland:1


# ─────────────────────────────────────
#   FLOATING WINDOWS
# ─────────────────────────────────────
# Generic dialogs — float + center
windowrulev2 = float,  title:^(Open File|Select a File|Choose wallpaper|Open Folder|Save As|Library|File Upload)(.*)$
windowrulev2 = center, title:^(Open File|Select a File|Choose wallpaper|Open Folder|Save As|Library|File Upload)(.*)$

# Wallpaper chooser — custom size
windowrulev2 = size 60% 65%, title:^(Choose wallpaper)(.*)$

# “Wants to save/open” dialogs
windowrulev2 = float,  title:^(.*)(wants to (save|open))$
windowrulev2 = center, title:^(.*)(wants to (save|open))$

# App-specific float rules
windowrulev2 = float, class:^(blueberry\.py|guifetch|Zotero)$
windowrulev2 = size 45%, class:^(Zotero)$

# PulseAudio / Pavucontrol
windowrulev2 = float,  class:^(pavucontrol|org\.pulseaudio\.pavucontrol)$
windowrulev2 = size 45%, class:^(pavucontrol|org\.pulseaudio\.pavucontrol)$
windowrulev2 = center, class:^(pavucontrol|org\.pulseaudio\.pavucontrol)$

# Network Manager editor
windowrulev2 = float, class:^(nm-connection-editor)$
windowrulev2 = size 45%, class:^(nm-connection-editor)$
windowrulev2 = center, class:^(nm-connection-editor)$

# KDE helpers / applets
windowrulev2 = float, class:.*plasmawindowed.*
windowrulev2 = float, class:kcm_.*
windowrulev2 = float, class:.*bluedevilwizard

# Misc popups
windowrulev2 = float, title:.*Welcome
windowrulev2 = float, title:^(illogical-impulse Settings)$
windowrulev2 = float, title:.*Shell conflicts.*

# Flatpak/KDE portals
windowrulev2 = float, class:org\.freedesktop\.impl\.portal\.desktop\.kde
windowrulev2 = size 60% 65%, class:org\.freedesktop\.impl\.portal\.desktop\.kde


# ─────────────────────────────────────
#   WINDOW MOVEMENT / FOCUS ODDITIES
# ─────────────────────────────────────
# KDE “change icons” — float + hide off-screen
windowrulev2 = float,          class:^(plasma-changeicons)$
windowrulev2 = noinitialfocus, class:^(plasma-changeicons)$
windowrulev2 = move 999999 999999, class:^(plasma-changeicons)$


########################################
#           THUNAR WINDOW RULES        #
########################################

# Main Thunar windows: subtle glass, tile by default
windowrulev2 = opacity 0.96 override 0.92 override, class:^(Thunar|thunar)$
windowrulev2 = rounding 14,                            class:^(Thunar|thunar)$
windowrulev2 = tile,                                   class:^(Thunar|thunar)$

# Properties & Preferences
windowrulev2 = float,  class:^(Thunar|thunar)$, title:^(Properties|Preferences)(.*)$
windowrulev2 = center, class:^(Thunar|thunar)$, title:^(Properties|Preferences)(.*)$
windowrulev2 = size 55% 60%, class:^(Thunar|thunar)$, title:^(Properties|Preferences)(.*)$

# Bulk Rename
windowrulev2 = float,  class:^(Thunar|thunar)$, title:.*(Bulk\s?Rename).*
windowrulev2 = center, class:^(Thunar|thunar)$, title:.*(Bulk\s?Rename).*
windowrulev2 = size 70% 65%, class:^(Thunar|thunar)$, title:.*(Bulk\s?Rename).*

# “Open With” / “Choose Application”
windowrulev2 = float,  class:^(Thunar|thunar)$, title:^(Open With|Choose Application)(.*)$
windowrulev2 = center, class:^(Thunar|thunar)$, title:^(Open With|Choose Application)(.*)$
windowrulev2 = size 55% 55%, class:^(Thunar|thunar)$, title:^(Open With|Choose Application)(.*)$

# File operation progress (Copy/Move/Delete/Merge/Replace)
windowrulev2 = float,          class:^(Thunar|thunar)$, title:^(File Operation Progress|Copying|Moving|Deleting|Transferring|Replacing|Merging)(.*)$
windowrulev2 = noinitialfocus, class:^(Thunar|thunar)$, title:^(File Operation Progress|Copying|Moving|Deleting|Transferring|Replacing|Merging)(.*)$
windowrulev2 = size 36% 22%,   class:^(Thunar|thunar)$, title:^(File Operation Progress|Copying|Moving|Deleting|Transferring|Replacing|Merging)(.*)$
windowrulev2 = move 40 80,     class:^(Thunar|thunar)$, title:^(File Operation Progress|Copying|Moving|Deleting|Transferring|Replacing|Merging)(.*)$
# Extra catch for some themes that name it like “Copying — thunar”
windowrulev2 = float,          class:^(Thunar|thunar)$, title:^Copying( —| -)? thunar(.*)$
windowrulev2 = noinitialfocus, class:^(Thunar|thunar)$, title:^Copying( —| -)? thunar(.*)$
windowrulev2 = size 36% 22%,   class:^(Thunar|thunar)$, title:^Copying( —| -)? thunar(.*)$
windowrulev2 = move 40 80,     class:^(Thunar|thunar)$, title:^Copying( —| -)? thunar(.*)$

# Confirms / conflicts
windowrulev2 = float,  class:^(Thunar|thunar)$, title:^(Replace|Overwrite|Merge|Empty Trash|Confirm|Permissions)(.*)$
windowrulev2 = center, class:^(Thunar|thunar)$, title:^(Replace|Overwrite|Merge|Empty Trash|Confirm|Permissions)(.*)$
windowrulev2 = size 45% 40%,  class:^(Thunar|thunar)$, title:^(Replace|Overwrite|Merge|Empty Trash|Confirm|Permissions)(.*)$

# Thunar “Open/Save/File Upload” (fallback if global rules miss)
windowrulev2 = float,  class:^(Thunar|thunar)$, title:^(Open File|Save As|File Upload)(.*)$
windowrulev2 = center, class:^(Thunar|thunar)$, title:^(Open File|Save As|File Upload)(.*)$
windowrulev2 = size 60% 65%, class:^(Thunar|thunar)$, title:^(Open File|Save As|File Upload)(.*)$

# Thunar Custom Actions editor
windowrulev2 = float,  class:^(Thunar|thunar)$, title:.*(Custom Action|Custom Actions).*
windowrulev2 = center, class:^(Thunar|thunar)$, title:.*(Custom Action|Custom Actions).*
windowrulev2 = size 60% 60%, class:^(Thunar|thunar)$, title:.*(Custom Action|Custom Actions).*

# Catfish (if launched from Thunar)
windowrulev2 = float,  class:^(catfish)$
windowrulev2 = center, class:^(catfish)$
windowrulev2 = size 70% 70%, class:^(catfish)$

# Yazi portal chooser (Wayland)
windowrulev2 = float,  class:^yazi-picker$
windowrulev2 = center, class:^yazi-picker$
windowrulev2 = size 70% 70%, class:^yazi-picker$

# Optional: catch initial title
windowrulev2 = float,  initialtitle:^Yazi File Picker$
windowrulev2 = center, initialtitle:^Yazi File Picker$
windowrulev2 = size 70% 70%, initialtitle:^Yazi File Picker$


# ─────────────────────────────────────
#   WORKSPACE-SPECIFIC RULES
# ─────────────────────────────────────
# Workspace 2: Remove rounding and borders for tiled windows only
windowrulev2 = rounding 0, workspace:2, floating:0
windowrulev2 = noborder, workspace:2, floating:0
windowrulev2 = noanim, workspace:2


# ─────────────────────────────────────
#   TEARING / PERFORMANCE
# ─────────────────────────────────────
# Immediate presentation (low-latency, may tear)
windowrulev2 = immediate, title:.*\.exe
windowrulev2 = immediate, title:.*minecraft.*
windowrulev2 = immediate, class:^(steam_app).*


# ─────────────────────────────────────
#   TILING RULES
# ─────────────────────────────────────
# Force Warp terminal to tile
windowrulev2 = tile, class:^dev\.warp\.Warp$


# ─────────────────────────────────────
#   PICTURE-IN-PICTURE
# ─────────────────────────────────────
windowrulev2 = float,           title:^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture)(.*)$
windowrulev2 = keepaspectratio, title:^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture)(.*)$
windowrulev2 = move 73% 72%,    title:^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture)(.*)$
windowrulev2 = size 25%,        title:^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture)(.*)$
windowrulev2 = pin,             title:^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture)(.*)$


########################################
#           WORKSPACE RULES            #
########################################
# Special scratchpad workspace
workspace = special:special, gapsout:30

# Workspace 2: No gaps for tiled windows (terminal workspace)
workspace = 2, gapsin:0, gapsout:0


########################################
#             LAYER RULES              #
########################################
# Global rules
layerrule = xray 1, .*
layerrule = noanim, noanim

# Disable animations for overlays
layerrule = noanim, walker|selection|overview|anyrun|indicator.*|osk|hyprpicker

# GTK layer-shell (Waybar, wlogout, etc.)
layerrule = blur, gtk-layer-shell
layerrule = ignorezero, gtk-layer-shell

# Launchers & notifications
layerrule = blur, launcher
layerrule = ignorealpha 0.5, launcher
layerrule = blur, notifications
layerrule = ignorealpha 0.69, notifications
layerrule = blur, logout_dialog

# AGS surfaces
layerrule = animation slide left,  sideleft.*
layerrule = animation slide right, sideright.*
layerrule = blur, bar[0-9]*|session[0-9]*|dock[0-9]*|indicator.*|overview[0-9]*|cheatsheet[0-9]*|sideright[0-9]*|sideleft[0-9]*|osk[0-9]*
layerrule = ignorealpha 0.6, bar[0-9]*|barcorner.*|dock[0-9]*|indicator.*|overview[0-9]*|cheatsheet[0-9]*|sideright[0-9]*|sideleft[0-9]*|osk[0-9]*

# Quickshell
layerrule = blurpopups, quickshell:.*
layerrule = blur, quickshell:.*
layerrule = ignorealpha 0.79, quickshell:.*
layerrule = animation slide, quickshell:bar|quickshell:verticalBar
layerrule = animation fade,  quickshell:screenCorners|quickshell:notificationPopup
layerrule = animation slide right, quickshell:sidebarRight
layerrule = animation slide left,  quickshell:sidebarLeft
layerrule = animation slide bottom, quickshell:osk|quickshell:dock
layerrule = noanim, quickshell:session|quickshell:overview|gtk4-layer-shell|quickshell:screenshot|quickshell:lockWindowPusher
layerrule = blur, quickshell:session|quickshell:backgroundWidgets
layerrule = ignorealpha 0,    quickshell:session
layerrule = ignorealpha 0.05, quickshell:backgroundWidgets

# Outfoxxed’s shell namespace
layerrule = blur, shell:bar|shell:notifications
layerrule = ignorezero, shell:bar
layerrule = ignorealpha 0.1, shell:notifications


########################################
#             SCRATCHPADS              #
########################################
# CopyQ scratchpad
windowrulev2 = float,  class:^(copyq|CopyQ|com\.github\.hluk\.copyq)$
windowrulev2 = center, class:^(copyq|CopyQ|com\.github\.hluk\.copyq)$
windowrulev2 = size 900 600, class:^(copyq|CopyQ|com\.github\.hluk\.copyq)$

# Yazi FM popup (kitty wrapper)
windowrulev2 = workspace special:yazi, class:^yazi-fm$
windowrulev2 = float,  class:^yazi-fm$
windowrulev2 = center, class:^yazi-fm$
windowrulev2 = size 80% 75%, class:^yazi-fm$
windowrulev2 = stayfocused, class:^yazi-fm$
windowrulev2 = rounding 18, class:^yazi-fm$
windowrulev2 = opacity 0.97 override 0.97 override, class:^yazi-fm$


########################################
# Zathura — single global tab group (ws 11)
########################################
windowrulev2 = workspace 11, class:^(org\.pwmt\.zathura.*)$
windowrulev2 = group set lock invade, class:^(org\.pwmt\.zathura.*)$


########################################
# Albert — zero chrome, zero blur/halo
########################################
windowrulev2 = float,             class:^(albert)$
windowrulev2 = center,            class:^(albert)$
windowrulev2 = size 600 400,      class:^(albert)$
windowrulev2 = noborder,          class:^(albert)$
windowrulev2 = noshadow,          class:^(albert)$
windowrulev2 = rounding 0,        class:^(albert)$
windowrulev2 = noblur,            class:^(albert)$
windowrulev2 = opacity 0.97 0.97, class:^(albert)$
windowrulev2 = stayfocused,       class:^(albert)$
windowrulev2 = noanim,            class:^(albert)$


# Detach the current window from the group (your “pull it out” action)
bind = $mainMod SHIFT, U, moveoutofgroup
# (Optional) Re-attach a focused Zathura to the nearest group in the stack
bind = $mainMod SHIFT, I, moveintogroup, l

